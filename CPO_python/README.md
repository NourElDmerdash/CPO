# Crested Porcupine Optimizer (CPO) - Python Implementation

هذا المشروع هو تنفيذ لخوارزمية Crested Porcupine Optimizer (CPO) بلغة Python، وهي خوارزمية تحسين جديدة مستوحاة من الطبيعة طورها Abdel-Basset, M. و Mohamed, R.

## نظرة عامة

خوارزمية CPO مستوحاة من آليات الدفاع لدى النيص الأفريقي ذو العرف (Crested Porcupine). تستخدم هذه الآليات للموازنة بين الاستكشاف والاستغلال في عملية البحث عن الحل الأمثل.

## هيكل المشروع

- `cpo.py` - التنفيذ الأساسي لخوارزمية CPO
- `benchmark_functions.py` - دوال مساعدة للدوال المعيارية CEC
- `cec_functions_wrapper.py` - واجهة ربط مع دوال CEC المنفذة بلغة C++
- `cec_functions_data.py` - إدارة ملفات بيانات CEC (مصفوفات الدوران، بيانات الإزاحة، الخ)
- `main.py` - سكريبت لتشغيل CPO على دوال CEC المعيارية
- `example.py` - مثال بسيط يوضح تشغيل CPO على دوال اختبار قياسية
- `testing.py` - اختبارات للتحقق من صحة واجهة دوال CEC

## المتطلبات

- NumPy (>= 1.19.0)
- Matplotlib (>= 3.3.0)
- SciPy (>= 1.5.0)
- CFFI (>= 1.14.0)
- مترجم C++ (مثل GCC) لترجمة كود C++ الخاص بدوال CEC

## طريقة الاستخدام

### تثبيت المتطلبات

```
pip install -r requirements.txt
```

### إعداد دوال CEC

1. تأكد من وجود ملفات C++ لدوال CEC في المجلد الرئيسي (مثل `cec17_func.cpp`)
2. تأكد من وجود ملفات البيانات اللازمة في مجلد `input_data17` للتوافق مع دوال CEC-2017

### اختبار دوال CEC

للتحقق من صحة واجهة دوال CEC:

```
python testing.py
```

### مثال بسيط

لتشغيل CPO على دوال اختبار معيارية بسيطة:

```
python example.py
```

### تشغيل على دوال CEC

لتشغيل CPO على دوال CEC المعيارية:

```
python main.py
```

## دليل التشغيل خطوة بخطوة

### الخطوة 1: إعداد بيئة التشغيل
1. قم بتنزيل الكود من المستودع وحفظه في مجلد على جهازك
2. افتح موجه الأوامر (Terminal) في نظام التشغيل الخاص بك
3. انتقل إلى مجلد المشروع باستخدام الأمر `cd`:
   ```
   cd المسار/إلى/مجلد/CPO_python
   ```
4. قم بإنشاء بيئة افتراضية Python (اختياري ولكن مستحسن):
   ```
   # في نظام Windows
   python -m venv venv
   venv\Scripts\activate
   
   # في نظام macOS/Linux
   python3 -m venv venv
   source venv/bin/activate
   ```
5. قم بتثبيت المكتبات المطلوبة:
   ```
   pip install -r requirements.txt
   ```

### الخطوة 2: إعداد دوال CEC وملفات البيانات
1. قم بنسخ ملفات C++ الخاصة بدوال CEC إلى المجلد الرئيسي للمشروع:
   - `cec14_func.cpp` (لـ CEC-2014)
   - `cec17_func.cpp` (لـ CEC-2017)
   - `cec20_func.cpp` (لـ CEC-2020)
   - `cec22_func.cpp` (لـ CEC-2022)

2. قم بإنشاء المجلدات التالية في المجلد الرئيسي للمشروع (إذا لم تكن موجودة):
   ```
   mkdir input_data14
   mkdir input_data17
   mkdir input_data20
   mkdir input_data22
   ```

3. قم بنسخ ملفات البيانات المناسبة إلى كل مجلد:
   - ملفات `shift_data_*.txt` (بيانات الإزاحة)
   - ملفات `M_*_D*.txt` (مصفوفات الدوران)
   - ملفات `shuffle_data_*_D*.txt` (بيانات التبديل)

### الخطوة 3: اختبار واجهة دوال CEC
1. قم بتشغيل ملف الاختبار للتحقق من صحة تثبيت دوال CEC:
   ```
   python testing.py
   ```
2. تحقق من النتائج في موجه الأوامر:
   - إذا تم تحميل المكتبة بنجاح، ستظهر رسالة "CEC XXXX library loaded successfully"
   - إذا فشل التحميل، ستظهر رسالة خطأ وسيتم استخدام الدوال البديلة البسيطة

### الخطوة 4: تشغيل مثال بسيط
1. قم بتشغيل المثال البسيط للتحقق من عمل خوارزمية CPO:
   ```
   python example.py
   ```
2. سيتم تنفيذ الخوارزمية على ثلاث دوال اختبار قياسية (Sphere، Rosenbrock، Rastrigin)
3. ستظهر النتائج في موجه الأوامر وسيتم حفظ منحنيات التقارب كملفات صور

### الخطوة 5: تشغيل الخوارزمية على دوال CEC
1. افتح ملف `main.py` وتحقق من إعدادات الخوارزمية:
   - `pop_size`: حجم المجتمع (عدد العوامل)
   - `max_iter`: الحد الأقصى لعدد التكرارات
   - `num_runs`: عدد التشغيلات المستقلة
   - `cec_year`: سنة معيار CEC (1: CEC-2014، 2: CEC-2017، 3: CEC-2020، 4: CEC-2022)

2. قم بتشغيل الخوارزمية على دوال CEC:
   ```
   python main.py
   ```
3. سيتم طباعة النتائج في موجه الأوامر وحفظ منحنيات التقارب كملفات صور

### الخطوة 6: تخصيص الخوارزمية
1. لتعديل معلمات الخوارزمية، افتح ملف `main.py` وقم بتغيير القيم المناسبة
2. لاستخدام الخوارزمية مع دالة تكلفة مخصصة، يمكنك إنشاء ملف Python جديد واستيراد الخوارزمية:
   ```python
   import numpy as np
   from cpo import cpo
   
   # تعريف دالة التكلفة المخصصة
   def my_custom_function(x):
       # قم بتنفيذ دالة التكلفة الخاصة بك هنا
       return np.sum(x**2)
   
   # تحديد معلمات المشكلة
   dim = 10
   lb = -100 * np.ones(dim)
   ub = 100 * np.ones(dim)
   
   # تشغيل خوارزمية CPO
   best_fitness, best_position, convergence = cpo(
       pop_size=50,
       max_iter=1000,
       ub=ub,
       lb=lb,
       dim=dim,
       obj_func=my_custom_function
   )
   
   # طباعة النتائج
   print(f"أفضل لياقة: {best_fitness}")
   print(f"أفضل حل: {best_position}")
   ```

### الخطوة 7: استكشاف الأخطاء وإصلاحها
إذا واجهت مشاكل في تشغيل الكود، اتبع الخطوات التالية:

1. **مشكلة في ترجمة ملفات C++**:
   - تأكد من تثبيت مترجم C++ على جهازك (مثل GCC أو Visual C++)
   - تحقق من وجود ملفات المصدر C++ في المجلد الصحيح
   - جرب ترجمة الملفات يدويًا باستخدام الأوامر المذكورة في ملف `cec_functions_wrapper.py`

2. **مشكلة في ملفات البيانات**:
   - تأكد من وجود ملفات البيانات في المجلدات المناسبة
   - تحقق من تنسيق الملفات (يجب أن تكون ملفات نصية)
   - راجع رسائل الخطأ في موجه الأوامر للحصول على مزيد من المعلومات

3. **مشكلة في تثبيت المكتبات**:
   - تأكد من تثبيت جميع المكتبات المطلوبة بالإصدارات المناسبة
   - جرب تحديث المكتبات باستخدام الأمر: `pip install --upgrade -r requirements.txt`

## تنفيذ دوال CEC

يدعم المشروع الحالي دوال CEC لسنوات مختلفة:
- CEC-2014 (cec_year=1)
- CEC-2017 (cec_year=2)
- CEC-2020 (cec_year=3)
- CEC-2022 (cec_year=4)

الواجهة تعمل على إنشاء مكتبة مشتركة من ملفات C++ الموجودة، وبالتالي تحتاج إلى:

1. ملفات المصدر C++ (مثل `cec17_func.cpp`)
2. ملفات البيانات (مثل ملفات الإزاحة ومصفوفات الدوران) في المجلدات المناسبة

## استخدام CPO مع دالة تكلفة مخصصة

```python
import numpy as np
from cpo import cpo

# تعريف دالة التكلفة المخصصة
def my_objective_function(x):
    return np.sum(x**2)  # مثال: دالة Sphere

# تحديد أبعاد المشكلة والحدود
dim = 10
lb = -100 * np.ones(dim)
ub = 100 * np.ones(dim)

# تشغيل خوارزمية CPO
best_fitness, best_position, convergence = cpo(
    pop_size=50,
    max_iter=1000,
    ub=ub,
    lb=lb,
    dim=dim,
    obj_func=my_objective_function
)

print(f"أفضل لياقة: {best_fitness}")
print(f"أفضل موقع: {best_position}")
```

## المراجع

> Abdel-Basset, M., Mohamed, R. "Crested Porcupine Optimizer: A new nature-inspired metaheuristic" 